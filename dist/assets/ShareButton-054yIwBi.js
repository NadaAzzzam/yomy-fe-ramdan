import{r as C,j as d,h as j,y as D,z as I,A as L,B}from"./vendor-BiHAOAa9.js";import{u as H,f as N}from"./index-DUm4aSj_.js";const h=32,g=340,E=200,_="16px 'Noto Sans Arabic', 'Tajawal', sans-serif",A="18px 'Amiri', 'Noto Naskh Arabic', serif",k="12px 'Noto Sans Arabic', 'Tajawal', sans-serif",y="#D4A84B",F="#F3EDE0",$="#7E87AA";function P(e,n,a,r){e.save(),e.font=r,e.direction="rtl";const o=[],i=n.split(/\s+/).filter(Boolean);let t="";for(let s=i.length-1;s>=0;s--){const l=i[s],c=t?l+" "+t:l;e.measureText(c).width>a&&t?(o.push(t),t=l):t=c}return t&&o.push(t),e.restore(),o}function R(e,n,a,r,o,i){e.beginPath(),e.moveTo(n+i,a),e.lineTo(n+r-i,a),e.quadraticCurveTo(n+r,a,n+r,a+i),e.lineTo(n+r,a+o-i),e.quadraticCurveTo(n+r,a+o,n+r-i,a+o),e.lineTo(n+i,a+o),e.quadraticCurveTo(n,a+o,n,a+o-i),e.lineTo(n,a+i),e.quadraticCurveTo(n,a,n+i,a),e.closePath()}function U(e){const{title:n,body:a,source:r=""}=e,o=document.createElement("canvas"),i=Math.min(2,window.devicePixelRatio||1),t=o.getContext("2d");if(!t)return Promise.reject(new Error("Canvas not supported"));const s=g-h*2;o.width=g*i,o.height=E*i,t.scale(i,i),t.font=A,t.direction="rtl";const l=P(t,a,s,A),c=32,f=l.length*c,p=24,v=r?20:0,m=Math.max(E,h*2+p+12+f+(r?12+v:0));o.height=m*i,t.scale(i,i),t.clearRect(0,0,g,m);const u=g,T=m,b=t.createLinearGradient(0,0,u,T);b.addColorStop(0,"#111936"),b.addColorStop(1,"#172049"),R(t,0,0,u,T,20),t.fillStyle=b,t.fill(),t.strokeStyle=y+"40",t.lineWidth=1,R(t,0,0,u,T,20),t.stroke(),t.font=_,t.fillStyle=y,t.textAlign="center",t.textBaseline="middle",t.direction="rtl",t.fillText(n,u/2,h+p/2),t.font=A,t.fillStyle=F,t.textAlign="center";let S=h+p+12+c/2;for(const w of l)t.fillText(w,u/2,S),S+=c;return r&&(t.font=k,t.fillStyle=$,t.fillText("— "+r,u/2,S+12+v/2)),new Promise((w,O)=>{o.toBlob(x=>x?w(x):O(new Error("toBlob failed")),"image/png",.92)})}async function q(e){const{title:n,text:a,source:r}=e,o=r?`"${a}"
— ${r}
${n}`:`"${a}"
${n}`;if(navigator.share)try{return await navigator.share({title:n,text:o}),!0}catch(i){if(i.name==="AbortError")return!1}try{return await navigator.clipboard.writeText(o),!0}catch{return!1}}async function G(e){const n=await U({title:e.title,body:e.text,source:e.source}),a=new File([n],"hadith.png",{type:"image/png"});if(navigator.share&&navigator.canShare?.({files:[a]}))try{return await navigator.share({title:e.title,files:[a]}),!0}catch(i){if(i.name==="AbortError")return!1}const r=URL.createObjectURL(n),o=document.createElement("a");return o.href=r,o.download="hadith.png",o.click(),setTimeout(()=>URL.revokeObjectURL(r),100),!0}function z({content:e,label:n="مشاركة",compact:a=!0,style:r={}}){const o=H(),[i,t]=C.useState(!1),[s,l]=C.useState(null),c=async f=>{l(f);try{f==="text"?await q(e):await G(e),t(!1)}finally{l(null)}};return d.jsxs(d.Fragment,{children:[d.jsxs("button",{type:"button",onClick:()=>t(!0),disabled:s!==null,"aria-label":n,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:6,padding:a?"8px 10px":"10px 14px",borderRadius:12,border:`1px solid ${o.gold}35`,background:`${o.gold}0C`,color:o.gold,fontSize:12,fontWeight:600,fontFamily:N,cursor:s?"wait":"pointer",opacity:s?.7:1,transition:"all .2s",...r},children:[d.jsx(j,{icon:D,style:{fontSize:18}}),!a&&d.jsx("span",{children:n})]}),d.jsx(I,{isOpen:i,onDidDismiss:()=>t(!1),header:n,buttons:[{text:"مشاركة كنص (واتساب، رسالة…)",icon:L,handler:()=>c("text")},{text:"مشاركة كصورة (ستوري، حفظ صورة)",icon:B,handler:()=>c("image")},{text:"إلغاء",role:"cancel"}]})]})}export{z as S};
