import{r as f}from"./vendor-DjvLYLbv.js";const j=["صلاة الرغائب","بدعة","بدعي","مبتدع","مبتدعة","أهل البدع","الاحتفال بالمولد","ذكر جماعي بصيغة واحدة بعد الصلاة"],R=["وصدق الله العظيم","صدق الله العظيم","و صدق الله العظيم","، وصدق الله العظيم","، صدق الله العظيم"];function S(t){if(t==null||typeof t!="string")return!0;const e=t.trim().replace(/\s+/g," ");for(const n of j)if(e.includes(n))return!1;return!0}function k(t){if(t==null||typeof t!="string")return"";let e=t.trim().replace(/\s+/g," ");for(const n of R){const r=n.trim();if(e.endsWith(r)){e=e.slice(0,-r.length).trim();break}}return e}const _="https://cdn.jsdelivr.net/gh/fawazahmed0/hadith-api@1",g="yomy-api-cache:";function $(t,e){try{const n=localStorage.getItem(g+t);return n?(e!=null&&Date.now()>e,JSON.parse(n)):null}catch{return null}}function b(t,e,n){try{const r=n!=null?{_exp:n,data:e}:e;localStorage.setItem(g+t,JSON.stringify(r))}catch{}}function p(t){try{const e=localStorage.getItem(g+t);if(!e)return null;const n=JSON.parse(e);return n._exp!=null&&Date.now()>n._exp?null:n.data??n}catch{return null}}function C(){const t=new Date;return t.setHours(23,59,59,999),t.getTime()}function K(t){return t?t.replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]+>/g,""):""}async function F(t="ara-bukhari",e=1){const n=`hadith:${t}:${e}`,r=$(n);if(r?.text&&S(r.text))return r;try{const a=`${_}/editions/${t}/${e}.min.json`,o=await fetch(a);if(!o.ok)return null;const s=await o.json(),l=s?.hadiths?.[0]?.text??"",c=s?.metadata?.name??t;if(!S(l))return null;const u={text:l,source:c};return b(n,u),u}catch{return $(n)}}function D(t,e=1500){return t%e+1}function X(t,e){const[n,r]=f.useState(()=>e[t%e.length]),[a,o]=f.useState(!0);return f.useEffect(()=>{let s=!1;o(!0);const i=D(t);return F("ara-bukhari",i).then(l=>{s||(l?.text?r(l):r(e[t%e.length]),o(!1))}),()=>{s=!0}},[t,e]),{hadith:n,loading:a}}const U="https://api.aladhan.com/v1";function I(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return`${e}-${n}-${r}`}async function O(t="Cairo",e="Egypt",n=5){const r=I(),a=`prayer:${r}:city:${t}:${e}:${n}`,o=p(a);if(o)return o;try{const s=`${U}/timingsByCity/${r}?city=${encodeURIComponent(t)}&country=${encodeURIComponent(e)}&method=${n}`,i=await fetch(s);if(!i.ok)return null;const c=(await i.json())?.data?.timings;if(!c)return null;const u=d=>(d??"").replace(/\s*\(.*\)/,"").trim(),y={Fajr:u(c.Fajr),Sunrise:u(c.Sunrise),Dhuhr:u(c.Dhuhr),Asr:u(c.Asr),Maghrib:u(c.Maghrib),Isha:u(c.Isha)};return b(a,y,C()),y}catch{return p(a)}}async function P(t,e,n=5){const r=I(),a=`prayer:${r}:coords:${t.toFixed(4)}:${e.toFixed(4)}:${n}`,o=p(a);if(o)return o;try{const s=`${U}/timings/${r}?latitude=${t}&longitude=${e}&method=${n}`,i=await fetch(s);if(!i.ok)return null;const c=(await i.json())?.data?.timings;if(!c)return null;const u=d=>(d??"").replace(/\s*\(.*\)/,"").trim(),y={Fajr:u(c.Fajr),Sunrise:u(c.Sunrise),Dhuhr:u(c.Dhuhr),Asr:u(c.Asr),Maghrib:u(c.Maghrib),Isha:u(c.Isha)};return b(a,y,C()),y}catch{return p(a)}}function Y(t,e,n,r,a){const[o,s]=f.useState(null),[i,l]=f.useState(!0),[c,u]=f.useState(!1),y=typeof r=="number"&&Number.isFinite(r)&&typeof a=="number"&&Number.isFinite(a);return f.useEffect(()=>{let d=!1;return l(!0),u(!1),(y?P(r,a,n):O(t,e,n)).then(w=>{d||(w?(s(w),u(!1)):u(!0),l(!1))}),()=>{d=!0}},[y,t,e,n,r,a]),{times:o,loading:i,error:c}}function q(t){if(!t||!t.trim())return t;const e=t.trim().split(":"),n=parseInt(e[0]??"0",10),r=parseInt(e[1]??"0",10),a=n===0?12:n>12?n-12:n,o=String(r).padStart(2,"0"),s=n<12?"ص":"م";return`${a}:${o} ${s}`}function G(t){const e=[{key:"Fajr",label:"الفجر"},{key:"Sunrise",label:"الشروق"},{key:"Dhuhr",label:"الظهر"},{key:"Asr",label:"العصر"},{key:"Maghrib",label:"المغرب"},{key:"Isha",label:"العشاء"}],n=new Date,r=n.getHours()*60+n.getMinutes();for(const o of e){const s=t[o.key];if(!s)continue;const[i,l]=s.split(":").map(Number),c=(i??0)*60+(l??0);if(c>r)return{key:o.key,label:o.label,time:s,minutesLeft:c-r}}const a=t.Fajr;if(a){const[o,s]=a.split(":").map(Number),i=(o??0)*60+(s??0),l=24*60-r+i;return{key:"Fajr",label:"الفجر (غداً)",time:a,minutesLeft:l}}return null}const T="yomy-azan-v1";let h=null,m=null;function A(){return typeof caches>"u"?Promise.resolve(null):caches.open(T).catch(()=>null)}async function x(t){const e=await A();if(!e)return null;try{const n=await e.match(t);if(!n||!n.ok)return null;const r=await n.blob();return URL.createObjectURL(r)}catch{return null}}async function W(t){const e=await A();if(!e)return!1;try{const n=t,r=await fetch(n);return r.ok?(await e.put(t,r),!0):!1}catch{return!1}}async function Z(t){const e=await A();if(!e)return!1;const n=await e.match(t);return n!=null&&n.ok}async function H(t){const e=await x(t);return e?{url:e,isBlob:!0}:{url:t,isBlob:!1}}function V(t){return new Promise(e=>{(async()=>{try{E();const{url:n,isBlob:r}=await H(t);r&&(m=n);const a=new Audio(n);a.volume=1,h=a;const o=()=>{a.removeEventListener("error",s),h===a&&(h=null),m===n&&r&&(URL.revokeObjectURL(n),m=null)},s=()=>{o(),E(),e(null)};a.addEventListener("error",s),a.addEventListener("ended",()=>{h===a&&(h=null),m===n&&r&&(URL.revokeObjectURL(n),m=null)}),a.play().then(()=>{a.removeEventListener("error",s),e(a)}).catch(()=>{s()})}catch{e(null)}})()})}function E(){m&&(URL.revokeObjectURL(m),m=null),h&&(h.pause(),h.currentTime=0,h=null)}const M="https://api.alquran.cloud/v1",N="yomy-quran-page-",z=604;function v(t){try{const e=localStorage.getItem(N+t);return e?JSON.parse(e):null}catch{return null}}function B(t){try{localStorage.setItem(N+t.pageNumber,JSON.stringify(t))}catch{}}async function tt(t){if(t<1||t>z)return null;const e=v(t);if(e)return L(e);if(typeof navigator<"u"&&!navigator.onLine)return null;try{const n=await fetch(`${M}/page/${t}`);if(!n.ok)return null;const a=(await n.json())?.data?.ayahs;if(!Array.isArray(a))return null;const o={pageNumber:t,ayahs:a.map(s=>({text:k(s.text),numberInSurah:s.numberInSurah,surah:{number:s.surah.number,name:s.surah.name}}))};return B(o),o}catch{const n=v(t);return n?L(n):null}}function L(t){return{pageNumber:t.pageNumber,ayahs:t.ayahs.map(e=>({...e,text:k(e.text)}))}}function et(){const[t,e]=f.useState(typeof navigator<"u"?navigator.onLine:!0);return f.useEffect(()=>{const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",r),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}},[]),t}function nt(t,e){const[n,r]=f.useState(()=>e[0]),[a,o]=f.useState(!0);return f.useEffect(()=>{const s=e[t%e.length]??e[0];r(s),o(!0);let i=!1;const l=t%42+1;return F("ara-nawawi",l).then(c=>{i||(c?.text?r(c):r(s),o(!1))}),()=>{i=!0}},[t,e]),{hadith:n,loading:a}}export{z as Q,nt as a,Y as b,q as c,W as d,E as e,K as f,G as g,et as h,Z as i,tt as j,V as p,k as s,X as u};
