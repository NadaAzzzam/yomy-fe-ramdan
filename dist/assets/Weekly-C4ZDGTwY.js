import{r as j,j as e,v as D,w as k}from"./vendor-DjvLYLbv.js";import{C as f}from"./Card-DTBY3kde.js";import{S as v}from"./Sec-DdRecG1O.js";import{R as w}from"./Ring-DOpZjx9L.js";import{u as $,f as z,c as A,A as C}from"./index-xbGL8iXn.js";function S(s){return s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0")}function R(s){const y=new Date,n=[],m=S(y),i=A(s);for(let d=6;d>=0;d--){const r=new Date(y);r.setDate(r.getDate()-d);const p=S(r),x=C[r.getDay()]??"â€”",c=p===m?i:s.dailyHistory[p];n.push({dateKey:p,dayName:x,pct:c?.pct??0,quran:c?.quran??!1,azkar:c?.azkar??!1,subha:c?.subha??!1,qiyam:c?.qiyam??!1})}return n}function o(s){return String(s).replace(/0/g,"Ù ").replace(/1/g,"Ù¡").replace(/2/g,"Ù¢").replace(/3/g,"Ù£").replace(/4/g,"Ù¤").replace(/5/g,"Ù¥").replace(/6/g,"Ù¦").replace(/7/g,"Ù§").replace(/8/g,"Ù¨").replace(/9/g,"Ù©")}function H({state:s,dispatch:y}){const n=$(),m=Object.keys(s.dailyHistory).length>0,i=j.useMemo(()=>R(s),[s]),d=i.length>0?Math.round(i.reduce((t,l)=>t+l.pct,0)/i.length):0,r=j.useMemo(()=>{const t=new Date;t.setDate(t.getDate()-14);let l=0,g=0;for(let h=0;h<7;h++){const u=new Date(t);u.setDate(u.getDate()+h);const a=S(u),b=s.dailyHistory[a];b!=null&&(l+=b.pct,g++)}return g===0?null:Math.round(l/g)},[s.dailyHistory]),p=r!=null?d-r:0,x=r!=null&&r>0?p>=0?"ðŸ“ˆ +"+o(p)+"%":"ðŸ“‰ âˆ’"+o(-p)+"%":null,c=j.useMemo(()=>{const t=i.length,l=i.filter(a=>a.quran).length,g=i.filter(a=>a.azkar).length,h=i.filter(a=>a.subha).length,u=i.filter(a=>a.qiyam).length;return[{icon:"ðŸ“–",l:"Ø§Ù„Ù‚Ø±Ø¢Ù†",v:`${o(l)}/${o(t)}`,p:t>0?Math.round(l/t*100):0,c:n.gold},{icon:"â˜€ï¸",l:"Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­ ÙˆØ§Ù„Ù…Ø³Ø§Ø¡",v:`${o(g)}/${o(t)}`,p:t>0?Math.round(g/t*100):0,c:n.orange},{icon:"ðŸ“¿",l:"Ø§Ù„Ø³ÙØ¨Ø­Ø©",v:`${o(h)}/${o(t)}`,p:t>0?Math.round(h/t*100):0,c:n.accent},{icon:"ðŸŒ™",l:"Ù‚ÙŠØ§Ù…",v:`${o(u)}/${o(t)}`,p:t>0?Math.round(u/t*100):0,c:n.purple}]},[i,n]);return e.jsx(D,{children:e.jsx(k,{fullscreen:!0,className:"ion-padding",style:{fontFamily:z,"--background":n.bg,color:n.text},children:e.jsxs("div",{className:"ion-content-inner",children:[e.jsxs("div",{style:{textAlign:"center",padding:"12px 0 6px"},children:[e.jsx("h2",{style:{fontFamily:"Amiri",fontSize:20,color:n.goldLight,margin:0},children:"ðŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ"}),m?e.jsx("button",{type:"button",onClick:()=>y({type:"CLEAR_DAILY_HISTORY"}),style:{marginTop:8,padding:"6px 14px",fontSize:11,color:n.muted,background:"transparent",border:`1px solid ${n.muted}30`,borderRadius:12,fontFamily:z,cursor:"pointer",fontWeight:600},children:"Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±"}):e.jsx("p",{style:{marginTop:6,fontSize:11,color:n.muted},children:"Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø¥Ù†Ø¬Ø§Ø²Ùƒ Ø§Ù„ÙØ¹Ù„ÙŠ ÙÙ‚Ø·"})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"14px 0"},children:e.jsxs(w,{pct:d,size:122,stroke:8,color:n.green,children:[e.jsxs("span",{style:{fontSize:26,fontWeight:800,color:n.green},children:[o(d),"%"]}),e.jsx("span",{style:{fontSize:9,color:n.muted},children:"Ø§Ù„Ù…Ø¹Ø¯Ù„"})]})}),x!=null&&e.jsx("div",{style:{textAlign:"center",marginBottom:12},children:e.jsx("span",{style:{background:`${n.green}12`,padding:"4px 12px",borderRadius:16,fontSize:11,color:n.green,fontWeight:700},children:x})}),e.jsxs(f,{glow:!0,children:[e.jsx(v,{icon:"ðŸ“Š",text:"Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…ÙŠ"}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",height:120,gap:4},children:i.map(t=>e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:3},children:[e.jsxs("span",{style:{fontSize:9,color:t.pct===100?n.green:n.muted,fontWeight:700},children:[o(t.pct),"%"]}),e.jsx("div",{style:{width:"100%",maxWidth:26,height:`${t.pct/100*75}px`,borderRadius:7,background:t.pct===100?n.green:t.pct>=80?n.gold:n.orange,opacity:.85,transition:"height .6s"}}),e.jsx("span",{style:{fontSize:9,color:n.muted},children:t.dayName})]},t.dateKey))})]}),e.jsxs(f,{style:{marginTop:12},children:[e.jsx(v,{icon:"ðŸ“‹",text:"Ø§Ù„ØªÙØ§ØµÙŠÙ„"}),c.map((t,l)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:9,padding:"7px 0",borderBottom:l<c.length-1?`1px solid ${n.muted}10`:"none"},children:[e.jsx("span",{style:{fontSize:16},children:t.icon}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:3},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:n.text},children:t.l}),e.jsx("span",{style:{fontSize:12,fontWeight:700,color:t.c},children:t.v})]}),e.jsx("div",{style:{width:"100%",height:4,background:`${t.c}1A`,borderRadius:2},children:e.jsx("div",{style:{width:`${t.p}%`,height:"100%",background:t.c,borderRadius:2}})})]})]},l))]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:9,marginTop:12},children:[e.jsxs(f,{style:{textAlign:"center",padding:"12px 8px"},children:[e.jsx("span",{style:{fontSize:22},children:"ðŸ”¥"}),e.jsx("p",{style:{fontSize:22,fontWeight:800,color:n.orange,margin:"2px 0 0"},children:o(s.streak)}),e.jsx("p",{style:{fontSize:9,color:n.muted},children:"Ù…ØªØªØ§Ù„ÙŠ"})]}),e.jsxs(f,{style:{textAlign:"center",padding:"12px 8px"},children:[e.jsx("span",{style:{fontSize:22},children:"âš¡"}),e.jsxs("p",{style:{fontSize:22,fontWeight:800,color:n.purple,margin:"2px 0 0"},children:["Ù… ",o(s.level)]}),e.jsx("p",{style:{fontSize:9,color:n.muted},children:s.level>=3?"Ù…Ø¬ØªÙ‡Ø¯":"Ù…Ø¨ØªØ¯Ø¦"})]})]})]})})})}export{H as Weekly};
