import{r as c}from"./vendor-Dv0kmEEh.js";const E="https://cdn.jsdelivr.net/gh/fawazahmed0/hadith-api@1";function D(t){return t?t.replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]+>/g,""):""}async function g(t="ara-bukhari",e=1){try{const n=`${E}/editions/${t}/${e}.min.json`,r=await fetch(n);if(!r.ok)return null;const a=await r.json(),s=a?.hadiths?.[0]?.text??"",u=a?.metadata?.name??t;return{text:s,source:u}}catch{return null}}function b(t,e=1500){return t%e+1}function L(t,e){const[n,r]=c.useState(()=>e[t%e.length]),[a,o]=c.useState(!0);return c.useEffect(()=>{let s=!1;o(!0);const u=b(t);return g("ara-bukhari",u).then(i=>{s||(i?.text?r(i):r(e[t%e.length]),o(!1))}),()=>{s=!0}},[t,e]),{hadith:n,loading:a}}const A="https://api.aladhan.com/v1";async function v(t="Cairo",e="Egypt",n=5){try{const r=new Date,a=String(r.getDate()).padStart(2,"0"),o=String(r.getMonth()+1).padStart(2,"0"),s=r.getFullYear(),u=`${a}-${o}-${s}`,i=`${A}/timingsByCity/${u}?city=${encodeURIComponent(t)}&country=${encodeURIComponent(e)}&method=${n}`,l=await fetch(i);if(!l.ok)return null;const h=(await l.json())?.data?.timings;if(!h)return null;const d=w=>(w??"").replace(/\s*\(.*\)/,"").trim();return{Fajr:d(h.Fajr),Sunrise:d(h.Sunrise),Dhuhr:d(h.Dhuhr),Asr:d(h.Asr),Maghrib:d(h.Maghrib),Isha:d(h.Isha)}}catch{return null}}function I(t,e,n){const[r,a]=c.useState(null),[o,s]=c.useState(!0),[u,i]=c.useState(!1);return c.useEffect(()=>{let l=!1;return s(!0),i(!1),v(t,e,n).then(m=>{l||(m?(a(m),i(!1)):i(!0),s(!1))}),()=>{l=!0}},[t,e,n]),{times:r,loading:o,error:u}}function F(t){if(!t||!t.trim())return t;const e=t.trim().split(":"),n=parseInt(e[0]??"0",10),r=parseInt(e[1]??"0",10),a=n===0?12:n>12?n-12:n,o=String(r).padStart(2,"0"),s=n<12?"ص":"م";return`${a}:${o} ${s}`}function R(t){const e=[{key:"Fajr",label:"الفجر"},{key:"Sunrise",label:"الشروق"},{key:"Dhuhr",label:"الظهر"},{key:"Asr",label:"العصر"},{key:"Maghrib",label:"المغرب"},{key:"Isha",label:"العشاء"}],n=new Date,r=n.getHours()*60+n.getMinutes();for(const o of e){const s=t[o.key];if(!s)continue;const[u,i]=s.split(":").map(Number),l=(u??0)*60+(i??0);if(l>r)return{key:o.key,label:o.label,time:s,minutesLeft:l-r}}const a=t.Fajr;if(a){const[o,s]=a.split(":").map(Number),u=(o??0)*60+(s??0),i=24*60-r+u;return{key:"Fajr",label:"الفجر (غداً)",time:a,minutesLeft:i}}return null}let f=null;function T(t){return new Promise(e=>{try{p();const n=new Audio(t);n.volume=1,f=n;const r=()=>{n.removeEventListener("error",a),f===n&&(f=null)},a=()=>{r(),p(),e(null)};n.addEventListener("error",a),n.addEventListener("ended",()=>{f===n&&(f=null)}),n.play().then(()=>{n.removeEventListener("error",a),e(n)}).catch(()=>{a()})}catch{e(null)}})}function p(){f&&(f.pause(),f.currentTime=0,f=null)}const $="https://api.alquran.cloud/v1",S="yomy-quran-";function y(t){try{const e=localStorage.getItem(S+t);return e?JSON.parse(e):null}catch{return null}}function k(t,e){try{localStorage.setItem(S+t,JSON.stringify(e))}catch{}}function C(t){return y(t)!==null}async function M(t){const e=y(t);if(e)return e;if(typeof navigator<"u"&&!navigator.onLine)return null;try{const n=await fetch(`${$}/surah/${t}`);if(!n.ok)return null;const a=(await n.json())?.data?.ayahs;if(!Array.isArray(a))return null;const o=a.map(s=>({number:s.number,text:s.text,numberInSurah:s.numberInSurah}));return k(t,o),o}catch{return y(t)}}function N(){const[t,e]=c.useState(typeof navigator<"u"?navigator.onLine:!0);return c.useEffect(()=>{const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",r),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}},[]),t}function x(t,e){const[n,r]=c.useState(()=>e[0]),[a,o]=c.useState(!0);return c.useEffect(()=>{const s=e[t%e.length]??e[0];r(s),o(!0);let u=!1;const i=t%42+1;return g("ara-nawawi",i).then(l=>{u||(l?.text?r(l):r(s),o(!1))}),()=>{u=!0}},[t,e]),{hadith:n,loading:a}}export{x as a,I as b,F as c,N as d,M as e,D as f,R as g,C as i,T as p,p as s,L as u};
